{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { Card } from 'react-native-elements';\nimport { getDatabase, ref, query, orderByChild, equalTo, limitToLast, onValue } from 'firebase/database';\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport { useList } from 'react-firebase-hooks/database';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from \"firebase/auth\";\nimport { getFunctions } from 'firebase/functions';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar firebaseConfig = {\n  apiKey: \"AIzaSyDBjUEw_DQNMQsZJWfTtLL0PQJoH-xF0kk\",\n  authDomain: \"sta-cs5041.firebaseapp.com\",\n  databaseURL: \"https://sta-cs5041-p4.firebaseio.com\",\n  projectId: \"sta-cs5041\",\n  storageBucket: \"sta-cs5041.appspot.com\",\n  messagingSenderId: \"639987847762\",\n  appId: \"1:639987847762:web:c5a35616a1aa1cf243458b\"\n};\nvar firebaseToken = \"9dd8d43a-01db-4286-b0e8-371d24237380\";\nvar firebaseApp = initializeApp(firebaseConfig);\nvar auth = getAuth(firebaseApp);\nvar database = getDatabase(firebaseApp);\nvar functions = getFunctions(firebaseApp);\nvar MuseumStoryCards = function MuseumStoryCards() {\n  var _useAuthState = useAuthState(auth),\n    _useAuthState2 = _slicedToArray(_useAuthState, 3),\n    user = _useAuthState2[0],\n    authLoading = _useAuthState2[1],\n    authError = _useAuthState2[2];\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    stories = _useState2[0],\n    setStories = _useState2[1];\n  var db = getDatabase();\n  var aliasQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(27));\n  var locationQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(29));\n  var timeQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(30));\n  var recipientQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(31));\n  var storyQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(32));\n  var _useList = useList(aliasQuery),\n    _useList2 = _slicedToArray(_useList, 1),\n    aliasSnapshot = _useList2[0];\n  var _useList3 = useList(locationQuery),\n    _useList4 = _slicedToArray(_useList3, 1),\n    locationSnapshot = _useList4[0];\n  var _useList5 = useList(timeQuery),\n    _useList6 = _slicedToArray(_useList5, 1),\n    timeSnapshot = _useList6[0];\n  var _useList7 = useList(recipientQuery),\n    _useList8 = _slicedToArray(_useList7, 1),\n    recipientSnapshot = _useList8[0];\n  var _useList9 = useList(storyQuery),\n    _useList10 = _slicedToArray(_useList9, 1),\n    storySnapshot = _useList10[0];\n  useEffect(function () {\n    if (user) {\n      console.log(\"Alias Snapshot:\", aliasSnapshot);\n      console.log(\"Location Snapshot:\", locationSnapshot);\n      console.log(\"Time Snapshot:\", timeSnapshot);\n      console.log(\"Recipient Snapshot:\", recipientSnapshot);\n      console.log(\"Story Snapshot:\", storySnapshot);\n      var formattedStories = formatStories(aliasSnapshot, locationSnapshot, timeSnapshot, recipientSnapshot, storySnapshot);\n      setStories(formattedStories);\n    }\n  }, [user, aliasSnapshot, locationSnapshot, timeSnapshot, recipientSnapshot, storySnapshot]);\n  var formatStories = function formatStories(alias, location, time, recipient, story) {\n    var formattedStories = [];\n    if (!alias || !location || !time || !recipient || !story) return formattedStories;\n    var maxLength = Math.max(alias.length, location.length, time.length, recipient.length, story.length);\n    for (var i = 0; i < maxLength; i++) {\n      formattedStories.push({\n        alias: alias[i] ? alias[i].val().string : \"\",\n        location: location[i] ? location[i].val().string : \"\",\n        time: time[i] ? time[i].val().string : \"\",\n        recipient: recipient[i] ? recipient[i].val().string : \"\",\n        story: story[i] ? story[i].val().string : \"\"\n      });\n    }\n    return formattedStories;\n  };\n  return _jsx(ScrollView, {\n    children: stories.map(function (story, index) {\n      return _jsxs(Card, {\n        children: [_jsx(Card.Title, {\n          children: story.alias\n        }), _jsx(Card.Divider, {}), _jsxs(View, {\n          children: [_jsxs(Text, {\n            style: styles.text,\n            children: [\"Location: \", story.location]\n          }), _jsxs(Text, {\n            style: styles.text,\n            children: [\"Time: \", story.time]\n          }), _jsxs(Text, {\n            style: styles.text,\n            children: [\"Recipient: \", story.recipient]\n          }), _jsxs(Text, {\n            style: styles.text,\n            children: [\"Story: \", story.story]\n          })]\n        })]\n      }, index);\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  text: {\n    marginBottom: 10\n  }\n});\nexport default MuseumStoryCards;","map":{"version":3,"names":["React","useEffect","useState","View","Text","StyleSheet","ScrollView","Card","getDatabase","ref","query","orderByChild","equalTo","limitToLast","onValue","useAuthState","useList","initializeApp","getAuth","getFunctions","jsx","_jsx","jsxs","_jsxs","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firebaseToken","firebaseApp","auth","database","functions","MuseumStoryCards","_useAuthState","_useAuthState2","_slicedToArray","user","authLoading","authError","_useState","_useState2","stories","setStories","db","aliasQuery","locationQuery","timeQuery","recipientQuery","storyQuery","_useList","_useList2","aliasSnapshot","_useList3","_useList4","locationSnapshot","_useList5","_useList6","timeSnapshot","_useList7","_useList8","recipientSnapshot","_useList9","_useList10","storySnapshot","console","log","formattedStories","formatStories","alias","location","time","recipient","story","maxLength","Math","max","length","i","push","val","string","children","map","index","Title","Divider","style","styles","text","create","marginBottom"],"sources":["/cs/home/sz78/Documents/P4_expo/MuseumStoryCards.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, ScrollView } from 'react-native';\nimport { Card } from 'react-native-elements';\nimport { getDatabase, ref, query, orderByChild, equalTo, limitToLast, onValue } from 'firebase/database';\nimport { useAuthState } from 'react-firebase-hooks/auth';\nimport { useList } from 'react-firebase-hooks/database';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from \"firebase/auth\";\nimport { getFunctions } from 'firebase/functions';\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyDBjUEw_DQNMQsZJWfTtLL0PQJoH-xF0kk\",\n    authDomain: \"sta-cs5041.firebaseapp.com\",\n    databaseURL: \"https://sta-cs5041-p4.firebaseio.com\",\n    projectId: \"sta-cs5041\",\n    storageBucket: \"sta-cs5041.appspot.com\",\n    messagingSenderId: \"639987847762\",\n    appId: \"1:639987847762:web:c5a35616a1aa1cf243458b\"\n};\n\nconst firebaseToken = \"9dd8d43a-01db-4286-b0e8-371d24237380\";\n\nconst firebaseApp = initializeApp(firebaseConfig);\nconst auth = getAuth(firebaseApp);\nconst database = getDatabase(firebaseApp);\nconst functions = getFunctions(firebaseApp);\n\nconst MuseumStoryCards = () => {\n    const [user, authLoading, authError] = useAuthState(auth);\n    const [stories, setStories] = useState([]);\n\n    const db = getDatabase();\n    const aliasQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(27));\n    const locationQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(29));\n    const timeQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(30));\n    const recipientQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(31));\n    const storyQuery = query(ref(db, 'data'), orderByChild('groupId'), equalTo(32));\n\n    const [aliasSnapshot] = useList(aliasQuery);\n    const [locationSnapshot] = useList(locationQuery);\n    const [timeSnapshot] = useList(timeQuery);\n    const [recipientSnapshot] = useList(recipientQuery);\n    const [storySnapshot] = useList(storyQuery);\n\n    useEffect(() => {\n        if (user) {\n            console.log(\"Alias Snapshot:\", aliasSnapshot);\n            console.log(\"Location Snapshot:\", locationSnapshot);\n            console.log(\"Time Snapshot:\", timeSnapshot);\n            console.log(\"Recipient Snapshot:\", recipientSnapshot);\n            console.log(\"Story Snapshot:\", storySnapshot);\n\n            const formattedStories = formatStories(\n                aliasSnapshot,\n                locationSnapshot,\n                timeSnapshot,\n                recipientSnapshot,\n                storySnapshot\n            );\n            setStories(formattedStories);\n        }\n    }, [user, aliasSnapshot, locationSnapshot, timeSnapshot, recipientSnapshot, storySnapshot]);\n\n    const formatStories = (alias, location, time, recipient, story) => {\n        const formattedStories = [];\n      \n        if (!alias || !location || !time || !recipient || !story) return formattedStories;\n      \n        // 查找数组中的最大长度\n        const maxLength = Math.max(alias.length, location.length, time.length, recipient.length, story.length);\n      \n        for (let i = 0; i < maxLength; i++) {\n          formattedStories.push({\n            alias: alias[i] ? alias[i].val().string : \"\",\n            location: location[i] ? location[i].val().string : \"\",\n            time: time[i] ? time[i].val().string : \"\",\n            recipient: recipient[i] ? recipient[i].val().string : \"\",\n            story: story[i] ? story[i].val().string : \"\",\n          });\n        }\n      \n        return formattedStories;\n      };      \n      \n    \n    return (\n        <ScrollView>\n            {stories.map((story, index) => (\n                <Card key={index}>\n                    <Card.Title>{story.alias}</Card.Title>\n                    <Card.Divider />\n                    <View>\n                        <Text style={styles.text}>Location: {story.location}</Text>\n                        <Text style={styles.text}>Time: {story.time}</Text>\n                        <Text style={styles.text}>Recipient: {story.recipient}</Text>\n                        <Text style={styles.text}>Story: {story.story}</Text>\n                    </View>\n                </Card>\n            ))}\n        </ScrollView>\n    );\n};\n\nconst styles = StyleSheet.create({\ntext: {\nmarginBottom: 10,\n},\n});\n\nexport default MuseumStoryCards;\n       \n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}